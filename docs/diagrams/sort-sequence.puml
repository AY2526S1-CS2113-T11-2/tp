@startuml
'@@author saheer17
!theme vibrant
actor User
participant ":Main" as Main
participant ":Parser" as Parser
participant ":ExpenseManager" as ExpenseManager
participant ":Ui" as Ui

User -> Main: sort
activate Main

Main -> Parser: parse("sort")
activate Parser

Parser -> Parser: parseSortCommand(arguments)
note right: Validates no arguments\nare provided

create participant ":SortCommand" as SortCommand
Parser -> SortCommand: new SortCommand()
activate SortCommand
deactivate Parser

Parser --> Main: sortCommand
deactivate Parser

Main -> SortCommand: execute(expenseManager, ui)

SortCommand -> Ui: showSeparator()
activate Ui
Ui --> SortCommand
deactivate Ui

SortCommand -> ExpenseManager: getSize()
activate ExpenseManager
ExpenseManager --> SortCommand: size
deactivate ExpenseManager

alt size == 0
    SortCommand -> Ui: showEmptyExpenseList()
    activate Ui
    Ui --> User: "No expenses added so far."
    deactivate Ui
else size > 0
    SortCommand -> ExpenseManager: sortExpenses()
    activate ExpenseManager

    ExpenseManager -> ExpenseManager: Create copy of expenses list
    ExpenseManager -> ExpenseManager: sort((e1, e2) -> compare amounts)
    note right: Sorts in descending order\n(highest amount first)

    ExpenseManager --> SortCommand: sortedExpenses
    deactivate ExpenseManager

    SortCommand -> Ui: showSortedExpenseList(sortedExpenses)
    activate Ui
    Ui --> User: Display sorted expenses
    deactivate Ui
end

SortCommand -> Ui: showSeparator()
activate Ui
Ui --> SortCommand
deactivate Ui

SortCommand --> Main
deactivate SortCommand

Main -> Main: StorageManager.saveExpenseManager()
note right: Persist changes to disk

Main --> User
deactivate Main

@enduml